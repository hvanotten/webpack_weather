(()=>{"use strict";const e=(e,t)=>{const{lat:n,lon:a,name:o,unit:s}=t;e.setLat(n),e.setLon(a),e.setName(o),s&&e.setUnit(s)},t=e=>{n(e),setTimeout(n,1e3,e)},n=e=>{e.classList.toggle("none"),e.nextElementSibling.classList.toggle("block"),e.nextElementSibling.classList.toggle("none")},a=(e,t)=>{s(e),c(t)},o=e=>e.split(" ").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "),s=e=>{const t=document.getElementById("currentForecast_location");if(-1!==e.indexOf("Lat:")&&-1!==e.indexOf("Long:")){const n=e.split(" ").map((e=>e.replace(":",": "))),a=-1===n[0].indexOf("-")?n[0].slice(0,10):n[0].slice(0,11),o=-1===n[1].indexOf("-")?n[1].slice(0,11):n[1].slice(0,12);t.textContent=`${a} • ${o}`}else t.textContent=e},c=e=>{document.getElementById("confirmation").textContent=e},i=()=>{const e=document.getElementById("currentForecast");e.classList.toggle("zero-vis"),e.classList.toggle("fade-in");const t=document.getElementById("dailyForecast");t.classList.toggle("zero-vis"),t.classList.toggle("fade-in")},r=e=>{let t=e.lastElementChild;for(;t;)e.removeChild(t),t=e.lastElementChild},d=(e,t)=>{const n=l("div","icon");n.id="icon";const a=m(e);return a.ariaHidden=!0,a.title=t,n.appendChild(a),n},l=(e,t,n,a)=>{const o=document.createElement(e);if(o.className=t,n&&(o.textContent=n),"temp"===t){const e=document.createElement("div");e.classList.add("unit"),e.textContent=a,o.appendChild(e)}return o},m=e=>{const t=document.createElement("i"),n=e.slice(0,2),a=e.slice(2);switch(n){case"01":"d"===a?t.classList.add("far","fa-sun"):t.classList.add("far","fa-moon");break;case"02":"d"===a?t.classList.add("far","fa-cloud-sun"):t.classList.add("far","fa-cloud-moon");break;case"03":t.classList.add("fas","fa-cloud");break;case"04":t.classList.add("fas","fa-cloud-meatball");break;case"09":t.classList.add("fas","fa-cloud-rain");break;case"10":"d"===a?t.classList.add("far","fa-cloud-sun-rain"):t.classList.add("far","fa-cloud-moon-rain");break;case"11":t.classList.add("fas","fa-poo-storm");break;case"13":t.classList.add("far","fa-snowflake");break;case"50":t.classList.add("fas","fa-smog");break;default:t.classList.add("far","fa-question-circle")}return t},u=e=>{const t=g(e.dt);return[l("p","dayAbbreviation",t),h(e.weather[0].icon,e.weather[0].description),l("p","dayHigh",`${Math.round(Number(e.temp.max))}°`),l("p","dayLow",`${Math.round(Number(e.temp.min))}°`)]},g=e=>new Date(1e3*e).toUTCString().slice(0,3).toUpperCase(),h=(e,t)=>{const n=document.createElement("img");return window.innerWidth<768||window.innerHeight<1025?n.src=`https://openweathermap.org/img/wn/${e}.png`:n.src=`https://openweathermap.org/img/wn/${e}@2x.png`,n.alt=t,n},p=e=>{const t=l("div","forecastDay");e.forEach((e=>{t.appendChild(e)})),document.getElementById("dailyForecast_contents").appendChild(t)},f=new class{constructor(){this._name="Current Location",this._lat=null,this._lon=null,this._unit="imperial"}getName(){return this._name}setName(e){this._name=e}getLat(){return this._lat}setLat(e){this._lat=e}getLon(){return this._lon}setLon(e){this._lon=e}getUnit(){return this._unit}setUnit(e){this._unit=e}toggleUnit(){this._unit="imperial"===this._unit?"metric":"imperial"}};document.addEventListener("DOMContentLoaded",(()=>{document.getElementById("getLocation").addEventListener("click",y),document.getElementById("home").addEventListener("click",b),document.getElementById("saveLocation").addEventListener("click",v),document.getElementById("unit").addEventListener("click",$),document.getElementById("refresh").addEventListener("click",C),document.getElementById("searchBar_form").addEventListener("submit",_),(()=>{const e=document.getElementById("searchBar_text");window.innerWidth<400?e.placeholder="City, State, Country":e.placeholder="City, State, Country, or Zip Code"})(),b()}));const y=e=>{if(e&&"click"===e.type){const e=document.querySelector(".fa-map-marker-alt");t(e)}navigator.geolocation||L(),navigator.geolocation.getCurrentPosition(E,L)},L=e=>{const t=e?e.message:"Geolocation not supported";a(t,t)},E=t=>{const n={lat:t.coords.latitude,lon:t.coords.longitude,name:`Lat:${t.coords.latitude} Long:${t.coords.longitude}`};e(f,n),k(f)},b=e=>{const n=localStorage.getItem("defaultWeatherLocation");if(!n&&!e)return y();if(n||"click"!==e.type)if(n&&!e)w(n);else{const e=document.querySelector(".fa-home");t(e),w(n)}else a("No Home Location Saved.","Sorry. Please save your home location first")},w=t=>{if("string"==typeof t){const n=JSON.parse(t),a={lat:n.lat,lon:n.lon,name:n.name,unit:n.unit};e(f,a),k(f)}},v=()=>{if(f.getLat()&&f.getLon()){const e=document.querySelector(".fa-save");t(e);const n={name:f.getName(),lat:f.getLat(),lon:f.getLon(),unit:f.getUnit()};localStorage.setItem("defaultWeatherLocation",JSON.stringify(n)),c(`Saved ${f.getName()} as home location.`)}},$=()=>{const e=document.querySelector(".fa-chart-bar");t(e),f.toggleUnit(),k(f)},C=()=>{const e=document.querySelector(".fa-sync-alt");t(e),k(f)},_=async n=>{n.preventDefault();const i=document.getElementById("searchBar_text").value.replaceAll(/ {2,}/g," ").trim();if(!i.length)return;const r=document.querySelector(".fa-search");t(r);const d=await(async(e,t)=>{const n=/^\d+$/g.test(e)?"zip":"q",a=encodeURI(`https://api.openweathermap.org/data/2.5/weather?${n}=${e}&units=${t}&appid=d0d332a66244b82bbb11b1927fdb2804`);try{const e=await fetch(a);return await e.json()}catch(e){console.error(e.stack)}})(i,f.getUnit());if(d)if(200===d.cod){const t={lat:d.coord.lat,lon:d.coord.lon,name:d.sys.country?`${d.name}, ${d.sys.country}`:d.name};e(f,t),k(f)}else(e=>{const t=o(e.message);s(t),c(`${t}. Please try again.`),console.error()})(d);else a("Connection Error","Connection Error")},k=async e=>{const t=await(async e=>{const t=`https://api.openweathermap.org/data/2.5/onecall?lat=${e.getLat()}&lon=${e.getLon()}&exclude=minutely,hourly,alerts&units=${e.getUnit()}&appid=d0d332a66244b82bbb11b1927fdb2804`;try{const e=await fetch(t);return await e.json()}catch(e){console.error(e)}})(e);t&&((e,t)=>{i(),(()=>{const e=document.getElementById("currentForecast_conditions");r(e);const t=document.getElementById("dailyForecast_contents");r(t)})();(e=>{document.documentElement.classList.add(e),document.documentElement.classList.forEach((t=>{t!==e&&document.documentElement.classList.remove(t)}))})((e=>{const t=e.slice(0,2),n=e.slice(2),a={"09":"snow",10:"rain",11:"rain",13:"snow",50:"fog"};let o;return o=a[t]?a[t]:"d"===n?"clouds":"night",o})(e.current.weather[0].icon));const n=((e,t)=>{const n=t.getName(),a="imperial"===t.getUnit()?"F":"C";return`${e.current.weather[0].description} and ${Math.round(Number(e.current.temp))}°${a} in ${n}`})(e,t);c(n),s(t.getName());(e=>{const t=document.getElementById("currentForecast_conditions");e.forEach((e=>{t.appendChild(e)}))})(((e,t)=>{const n="imperial"===t?"mph":"m/s",a=d(e.current.weather[0].icon,e.current.weather[0].description),s=l("div","temp",`${Math.round(Number(e.current.temp))}°`),c=o(e.current.weather[0].description);return[a,s,l("div","desc",c),l("div","feels",`Feels like ${Math.round(Number(e.current.feels_like))}°`),l("div","maxTemp",`High ${Math.round(Number(e.daily[0].temp.max))}°`),l("div","minTemp",`Low ${Math.round(Number(e.daily[0].temp.min))}°`),l("div","humidity",`Humidity ${e.current.humidity}%`),l("div","wind",`Wind ${Math.round(Number(e.current.wind_speed))} ${n}`)]})(e,t.getUnit())),(e=>{for(let t=1;t<=6;t++){const n=u(e.daily[t]);p(n)}})(e),document.getElementById("searchBar_text").focus(),i()})(t,e)}})();